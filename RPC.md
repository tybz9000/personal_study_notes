# RPC

Remote Procedure Call 远程过程调用

本地的机器调用了远程的服务

#### 一个RPC应该有啥

**实现远程调用**

##### 调用方、服务提供方

**接口定义**：公用jar包

**代理类**：消费者调用与实际远程调用的处理类

**注册中心**：提供方有哪些

**负载均衡**

**容错、协议、序列化**

## Dubbo

阿里提供的

19年正式毕业为Apache项目

![](D:\学习文件\dubbo.jpg)

#### Dubbo架构

1. 服务提供方注册服务到注册中心
2. 消费者注册消费到注册中心
3. 注册中心把元信息推送给消费者
4. 消费者调用服务提供方【可使用负载均衡策略】

##### Dubbo分层

**Service层**

业务层，业务逻辑代码层，一般使用者工作在这里

**RPC层**

Config：配置层，用来初始化配置信息，用来管理Dubbo的配置

Proxy：代理层，Dubbo调用中生产者、消费者都会产生代理对象，通过代理对象来调用远程

Registry：注册层，负责框架的服务注册和发现

Cluster：集群容错层，负责远程调用的容错策略

Monitor：监控层

Protocol：远程调用层，封装调用的基本过程

**Remoting层**

Exchange：信息交换层，封装request-response模型，分装请求响应模式

Transport：网络传输层

Serialize：序列化层

```
调用方、被调用方，定义服务，实现服务，是为Service层；
服务之间要能做到互相发现，需要注册层；
调用需要类增强，需要代理层；
代理后需要远程调用，需要远程调用层；
调用可能会错，需要集群容错层；
需要看调用情况，需要监控层；
需要配置，是为配置层；
牵线搭桥、妆点修饰、层层包装、远程调用
```

#### Invoker

**Invoker是Dubbo的核心模型**

Invoker是Dubbo中的实体域, 是真实存在的, 其他模型都在向她靠拢或者转换成它

它代表一个可执行体

在comsumer, 由它来调用provider

在provider, 由它来执行远程调用

### 杂谈

- 注册中心挂了可以继续通信么？
  - 可以，服务起来之后注册中心挂了可以，因为之前会缓存目标元数据
- 使用Dubbo协议，尽量避免大文件传输
- dubbo启动时默认检查provider，可以在spring配置中